{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\django-vue-admin3333\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Administrator\\Desktop\\django-vue-admin3333\\client\\src\\views\\system\\position.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin3333\\client\\src\\views\\system\\position.vue","mtime":1620834720964},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin3333\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin3333\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin3333\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\django-vue-admin3333\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {\n  getPositionAll,\n  createPosition,\n  deletePosition,\n  updatePosition\n} from '@/api/position'\nimport { genTree, deepClone } from '@/utils'\nimport checkPermission from '@/utils/permission'\n\nconst defaultM = {\n  id: '',\n  name: ''\n}\nexport default {\n  data() {\n    return {\n      position: {\n        id: '',\n        name: ''\n      },\n      search: '',\n      tableData: [],\n      positionList: [],\n      listLoading: true,\n      dialogVisible: false,\n      dialogType: 'new',\n      rule1: {\n        name: [{ required: true, message: '请输入名称', trigger: 'blur' }]\n      }\n    }\n  },\n  computed: {},\n  created() {\n    this.getList()\n  },\n  methods: {\n    checkPermission,\n    getList() {\n      this.listLoading = true\n      getPositionAll().then(response => {\n        this.positionList = response.data\n        this.tableData = response.data\n        this.listLoading = false\n      })\n    },\n    resetFilter() {\n      this.getList()\n    },\n    handleFilter() {\n      const newData = this.positionList.filter(\n        data =>\n          !this.search ||\n          data.name.toLowerCase().includes(this.search.toLowerCase())\n      )\n      this.tableData = genTree(newData)\n    },\n    handleAdd() {\n      this.position = Object.assign({}, defaultM)\n      this.dialogType = 'new'\n      this.dialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['Form'].clearValidate()\n      })\n    },\n    handleEdit(scope) {\n      this.position = Object.assign({}, scope.row) // copy obj\n      this.dialogType = 'edit'\n      this.dialogVisible = true\n      this.$nextTick(() => {\n        this.$refs['Form'].clearValidate()\n      })\n    },\n    handleDelete(scope) {\n      this.$confirm('确认删除?', '警告', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'error'\n      })\n        .then(async() => {\n          await deletePosition(scope.row.id)\n          this.getList()\n          this.$message({\n            type: 'success',\n            message: '成功删除!'\n          })\n        })\n        .catch(err => {\n          console.error(err)\n        })\n    },\n    async confirm(form) {\n      this.$refs[form].validate(valid => {\n        if (valid) {\n          const isEdit = this.dialogType === 'edit'\n          if (isEdit) {\n            updatePosition(this.position.id, this.position).then(() => {\n              this.getList()\n              this.dialogVisible = false\n              this.$message({\n                message: '编辑成功',\n                type: 'success',\n              })\n            })\n          } else {\n            createPosition(this.position).then(res => {\n              // this.position = res.data\n              // this.tableData.unshift(this.position)\n              this.getList()\n              this.dialogVisible = false\n              this.$message({\n                message: '新增成功',\n                type: 'success',\n              })\n            })\n          }\n        } else {\n          return false\n        }\n      })\n    }\n  }\n}\n",null]}